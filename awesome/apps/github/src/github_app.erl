%%%===================================================================
%%%
%%%===================================================================
-module(github_app).
-behavior(application).
-export([start/2, stop/1]).

%%--------------------------------------------------------------------
%%
%%--------------------------------------------------------------------
start(_,_) ->
    init(),
    github_sup:start_link().

%%--------------------------------------------------------------------
%%
%%--------------------------------------------------------------------
stop(_) ->
    ok.

%%--------------------------------------------------------------------
%% @doc throw an exception in case of issue
%% @end
%%--------------------------------------------------------------------
init() ->
    github_env:init([]),
    init_jobs().

%%--------------------------------------------------------------------
%% @doc jobs is required to limit the amount of requests made on
%% github api
%%
%% @end
%%--------------------------------------------------------------------
init_jobs() ->
    {ok, _} = application:ensure_all_started(jobs),
    ok = jobs:add_queue(github, []).
